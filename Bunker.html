<!DOCTYPE HTML>
<html>

<head>
    <link rel="icon" href="favicon.png">
    <link rel="manifest" href="manifest.json">
    <title>Bunker Offline</title>
    <style type="text/css">
        * {
            margin-left: 0;
            margin-right: 0;
            margin-top: 0;
            margin-bottom: 0;
            color: rgb(92, 255, 92);
            font: 15px Inconsolata, monospace;
            text-shadow: 0 0 5px rgb(95, 184, 95);
        }

        body {

            width: 400px;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            background-color: black;
            background-image: radial-gradient(rgba(0, 150, 0, 0.75), black 120%);
        }

        div {
            color: black;
            background: url(divback.jpg) rgb(94, 94, 94);
            width: 405px;
            border-style: solid;
            border-width: 2px;
        }

        .back {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: repeating-linear-gradient(0deg,
                    rgba(black, 0.15),
                    rgba(black, 0.15) 1px,
                    transparent 1px,
                    transparent 2px);
        }

        button {
            font-weight: bold;
            border-style: hidden;
            background-color: gray;
            background-color: transparent;
            border-radius: 15px;
            border-width: 1px;
            width: 100px;
        }

        img {
            box-shadow: 1px 1px 1px 1px black;
            border-style: solid;
            border-color: black;
            border-width: 2px;
            border-radius: 15px;
            width: 125px;
            height: 185px;
            perspective: 1000px;
            transition: transform 0.2s;
            transform-origin: center;
            transform-style: preserve-3d;
        }

        hr {
            background: url(balk.jpg) rgb(94, 94, 94);
            height: 21px;
            border-style: none;
            left: 0px;
            margin: 0;
            padding: 0;
            margin-left: 0px;
            width: 410px;
        }

        .imgcontext {
            position:fixed;
            left: 150px;
            top: 150px;
            z-index: 10;
            transform:scale(2.5);
            transition: transform 0.5s;
        }

        p {
            font-size: 20px;
            font-weight: bold;
        }

        .flip50 {
            transform: rotateY(-90deg);
        }

        .flip50back {
            transform: rotateY(0deg);
        }

        .invisleft {
            position: relative;
            left: -400px;            
        }

        .appearleft {
            position: relative;
            left: 0px;
            transition: left 5s ease 0s;
        }

        .invistrans {
            opacity: 0;
        }

        .appeartrans {
            opacity: 1;
            transition-property: opacity;
            transition-duration: 5s;
        }
    </style>
</head>

<body oncontextmenu='return false;' width=400>
    <meta http-equiv="Content-Type"
        content="text/html; charset=utf-8; initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width"
        name="viewport">
    <hr>

    <p class="invistrans">
        <Персонаж> <button onclick="GenerateNewSet()">[ Новый ]</button>
    </p>

    <hr>
    <div class="invisleft" onload="">
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Profession"
            onclick="ToggleFlip(this)" onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Biology" onclick="ToggleFlip(this)"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Health" onclick="ToggleFlip(this)"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Hobby" onclick="ToggleFlip(this)"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Facts" onclick="ToggleFlip(this)"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Bagage" onclick="ToggleFlip(this)"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='this.className="imgcontext"' pic='' id="Conditions"
            onclick="ToggleFlip(this)" onerror='DrawCard(this)'></img>
    </div>
    <hr>
    <p class="invistrans">
        <Бункер>
    </p>
    <hr>
    <div class="invisleft">
        <img src='face.jpg' oncontextmenu='DrawCard(this)' onclick="Zoom(this)" id="Bunker"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='DrawCard(this)' onclick="Zoom(this)" id="Cataclysm"
            onerror='DrawCard(this)'></img>
        <img src='face.jpg' oncontextmenu='DrawCard(this)' onclick="Zoom(this)" id="Threat"
            onerror='DrawCard(this)'></img>
    </div>

    <hr>

    <script type="text/javascript">

        var Selected = {};
        Selected.Profession = [];
        Selected.Biology = [];
        Selected.Health = [];
        Selected.Hobby = [];
        Selected.Facts = [];
        Selected.Bagage = [];
        Selected.Conditions = [];
        Selected.Bunker = [];
        Selected.Cataclysm = [];
        Selected.Threat = [];

        function Zoom(o) {
            if (o.getAttribute('class') == 'imgcontext') {
                o.className = 'flip50back';
            }
            else {
                o.className = 'imgcontext';
            }
        }

        function ToggleFlip(o) {
            if (o.getAttribute("class") == 'imgcontext') {
                o.className = 'flip50back';
            }
            else {
                o.className = 'flip50';
                if (o.getAttribute("src") == 'face.jpg') {
                    setTimeout(() => { o.src = o.id + '/' + o.getAttribute("pic") + '.jpg'; o.className = 'flip50back' }, 200);
                }
                else {
                    setTimeout(() => { o.src = 'face.jpg'; o.className = 'flip50back' }, 200);
                }
            }
        }
        function DrawCard(o) {
            o.className = 'flip50';
            let r = Math.floor(Math.random() * 50);
            if (r > 9) {
                r = '0' + r;
            }
            else {
                r = "00" + r;
            }
            setTimeout(() => { SelectedChecker(o, r) }, 500);
        }
        function SelectedChecker(o, r) {
            if (Selected[o.id].length == 0) {
                ErrorChecker(o, r);
            }
            else {
                for (let n = 0; n < Selected[o.id].length; n++) {
                    if (Selected[o.id][n] == r) {
                        console.log(Selected[o.id][n] + " — была");
                        DrawCard(o);
                        break;
                    }
                    else {
                        console.log(Selected[o.id][n] + " — старая");
                        ErrorChecker(o, r);
                        break;
                    }
                }
            }
        }
        function ErrorChecker(o, r) {
            o.src = o.id + '/' + r + '.jpg';
            AddToSelected(o, r);
            if (o.onerror == null) {
                console.log(Selected[o.id] + " — ошибка");
                DrawCard(o);
            }
            else {
                console.log(Selected[o.id][Selected[o.id].length - 1] + " — успешно")
                CheckExceptions(o);
                o.setAttribute('pic', r);
            }
        }
        function AddToSelected(o, r) {
            Selected[o.id].push(r);
        }
        function CheckExceptions(o) {
            setTimeout(() => { o.className = 'flip50back' }, 500);
            if (o.id != 'Bunker' && o.id != 'Cataclysm' && o.id != 'Threat') {
            }
        }

        function GenerateNewSet() {
            DrawCard(document.getElementById('Profession'));
            DrawCard(document.getElementById('Biology'));
            DrawCard(document.getElementById('Health'));
            DrawCard(document.getElementById('Hobby'));
            DrawCard(document.getElementById('Facts'));
            DrawCard(document.getElementById('Bagage'));
            DrawCard(document.getElementById('Conditions'));
        }
        function Appear() {
            let a = document.getElementsByClassName('invistrans');
            a.item(0).setAttribute('class', 'appeartrans');
            a.item(0).setAttribute('class', 'appeartrans');
            let b = document.getElementsByClassName('invisleft');
            b.item(0).setAttribute('class', 'appearleft');
            b.item(0).setAttribute('class', 'appearleft');

        }
        setTimeout(() => { Appear(); }, 1000);
    </script>

</body>

</html>